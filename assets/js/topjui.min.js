/* TopJUI前端框架，使用html调用组件功能的EasyUI极速开发框架 http://www.topjui.com 2017-03-04 */
function getTabWindow(){var a=null,b=parent.$("#index_tabs").tabs("getSelected");return b&&b.find("iframe").length>0&&(a=b.find("iframe")[0].contentWindow),a}function showMask(){$('<div class="datagrid-mask"></div>').css({display:"block",width:"100%",height:$(window).height()}).appendTo("body"),$('<div class="datagrid-mask-msg"></div>').html("正在处理，请稍候。。。").appendTo("body").css({display:"block",left:($(document.body).outerWidth(!0)-190)/2,top:($(window).height()-45)/2})}function hideMask(){$(".datagrid-mask").remove(),$(".datagrid-mask-msg").remove()}function addTab(a){var b='<iframe src="'+a.url+'" scrolling="auto" frameborder="0" style="width:100%;height:100%;"></iframe>',c=$("#index_tabs"),d={id:Math.random(),title:a.text,closable:"undefined"==typeof a.closable||a.closable,iconCls:a.iconCls?a.iconCls:"icon-page",content:b,border:a.border||!1,fit:!0};c.tabs("exists",d.title)?c.tabs("select",d.title):c.tabs("myAdd",d)}function bindMenuClickEvent(a,b){if("object"!=typeof b.grid){var c=getOptionsJson(a.closest("div"));b=$.extend(b,c)}var d={};if("openDialog"==b.clickEvent){d={iconCls:"icon-add",parentGridUnselectedMsg:"请先选中一条主表数据！",dialog:{title:"数据详情",width:650,height:400}},b.dialog.width=b.dialog.width?b.dialog.width:650,b.dialog.height=b.dialog.height?b.dialog.height:400,b=$.extend(d,b);var e="";if("object"==typeof b.parentGrid&&(e+=",parentGrid:{type:'"+b.parentGrid.type+"',id:'"+b.parentGrid.id+"',param:'"+b.parentGrid.param+"',unselectedMsg:'"+b.parentGrid.unselectedMsg+"'}"),"object"==typeof b.grid&&(e+=",grid:{type:'"+b.grid.type+"',id:'"+b.grid.id+"',pkName:'"+b.grid.pkName+"',parentIdField:'"+b.grid.parentIdField+"',unselectedMsg:'"+b.grid.unselectedMsg+"',uncheckedMsg:'"+b.grid.uncheckedMsg+"'}"),"object"==typeof b.dialog.editor){for(var f="",g="",h=0;h<b.dialog.editor.length;h++)h!=b.dialog.editor.length-1&&(g=","),f+="{id:'"+b.dialog.editor[h].id+"',type:'"+b.dialog.editor[h].type+"',field:'"+b.dialog.editor[h].field+"'}"+g;e+=",editor:["+f+"]"}b.dialog.title?"":b.dialog.title=a.text().replace(/[\r\n]/g,""),b.dialog.url?"":b.dialog.url="",b.dialog.beforeOpenCheckUrl?b.dialog.beforeOpenCheckUrl:b.dialog.beforeOpenCheckUrl="";var i=!0;""!=b.dialog.id&&null!=b.dialog.id||(i=!1,b.dialog.id="dialog-"+parseInt(99999999*Math.random()+1));var j="";j='<form data-toggle="topjui-dialog" data-options="id:\''+b.dialog.id+"',href:'"+b.dialog.href+"',url:'"+b.dialog.url+"',title:'"+b.dialog.title+"',beforeOpenCheckUrl:'"+b.dialog.beforeOpenCheckUrl+"'"+e+'"></form>';var k="";if("object"==typeof b.dialog.buttonsGroup){var l=b.dialog.buttonsGroup,m=l.length;if(m>0)for(var h=0;h<m;h++){l[h].handler||(l[h].handler="ajaxForm");var n="";if("object"==typeof b.grid&&(n=",grid:{type:'"+b.grid.type+"',id:'"+b.grid.id+"'}"),"object"==typeof l[h].reload){for(var o="",p="",q=0;q<l[h].reload.length;q++)q!=l[h].reload.length-1&&(p=","),o+="{type:'"+l[h].reload[q].type+"', id:'"+l[h].reload[q].id+"', clearQueryParams:'"+l[h].reload[q].clearQueryParams+"'}"+p;e+=",reload:["+o+"]"}k+='<a href="#" data-toggle="topjui-linkbutton" data-options="handlerBefore:\''+l[h].handlerBefore+"',handler:'"+l[h].handler+"',dialog:{id:'"+b.dialog.id+"'},url:'"+l[h].url+"',iconCls:'"+l[h].iconCls+"'"+e+'">'+l[h].text+"</a>"}}getTabWindow().$("body").append(j+'<div id="'+b.dialog.id+'-buttons" style="display:none">'+k+'<a href="#" data-toggle="topjui-linkbutton" data-options="iconCls:\'icon-no\'" onclick="javascript:$(\'#'+b.dialog.id+"').dialog('close')\">关闭</a></div>"),a.on("click",function(){if(i){if(!authCheck(b.dialog.id))return}else if(!authCheck(b.dialog.href))return;if(b.dialog.leftMargin=.5*$(document.body).width()-.5*b.dialog.width,b.dialog.topMargin=.5*$(document.body).height()-.5*b.dialog.height,"object"==typeof b.parentGrid)openDialogAndloadDataByParentGrid(b);else if(b.dialog.url)openDialogAndloadDataByUrl(b);else{if(b.grid.uncheckedMsg){var a=getCheckedRowsData(b.grid.type,b.grid.id);if(0==a.length)return void $.messager.alert(topJUI.language.message.title.operationTips,b.grid.uncheckedMsg,topJUI.language.message.icon.warning)}"undefined"!=b.dialog.onBeforeOpen&&executeCallBackFun(b.dialog.onBeforeOpen,b);var c=$("#"+b.dialog.id);c.dialog({width:b.dialog.width,height:b.dialog.height,maximized:b.dialog.maximized,maximizable:b.dialog.maximizable,left:b.dialog.leftMargin,top:b.dialog.topMargin,buttons:b.dialog.buttons}),c.dialog("refresh",appendSourceUrlParam(b.dialog.href)),c.dialog("open")}})}else"openTab"==b.clickEvent?(d={iconCls:"icon-add"},b=$.extend(d,b),a.on("click",function(){addParentTab(b)})):"openWindow"==b.clickEvent?(d={iconCls:"icon-add"},b=$.extend(d,b),a.on("click",function(){openWindow(b)})):"doAjax"==b.clickEvent?(d={iconCls:"icon-add"},b=$.extend(d,b),a.on("click",function(){doAjaxHandler(b)})):"delete"==b.clickEvent?(d={iconCls:"icon-delete"},b=$.extend(d,b),a.on("click",function(){deleteHandler(b)})):"filter"==b.clickEvent?(d={iconCls:"icon-filter"},b=$.extend(d,b),a.on("click",function(){filterHandler(b)})):"search"==b.clickEvent?(d={iconCls:"icon-search",href:"/system/search/advanceSearch"},b=$.extend(d,b),a.on("click",function(){searchHandler(b)})):"export"==b.clickEvent?(d={iconCls:"icon-table_go"},b=$.extend(d,b),a.on("click",function(){exportHandler(b)})):"import"==b.clickEvent&&(d={iconCls:"icon-table_go",href:"/system/excel/excelImport"},b=$.extend(d,b),a.on("click",function(){importHandler(b)}));return b}function openDialogAndloadDataByParentGrid(a){var b="",c="";"object"==typeof a.parentGrid&&(b=a.parentGrid.unselectedMsg,c=a.parentGrid.param,"datagrid"==a.parentGrid.type||"treegrid"==a.parentGrid.type);var d=getSelectedRowData(a.parentGrid.type,a.parentGrid.id);if(!d)return void $.messager.alert(topJUI.language.message.title.operationTips,a.parentGrid.unselectedMsg||topJUI.language.message.msg.selectParentGrid,topJUI.language.message.icon.warning);if(!a.dialog.beforeOpenCheckUrl||beforeOpenCheck(replaceUrlParamValueByBrace(a.dialog.beforeOpenCheckUrl,d))){var e=$("#"+a.dialog.id);e.dialog({width:a.dialog.width,height:a.dialog.height,maximized:a.dialog.maximized,maximizable:a.dialog.maximizable,left:a.dialog.leftMargin,top:a.dialog.topMargin,buttons:a.dialog.buttons});var f=a.dialog.href,g=f;if(a.dialog.href.indexOf("{")!=-1){if(a.dialog.href.indexOf("{parent.")!=-1&&(g=replaceUrlParamValueByBrace(appendSourceUrlParam(f),d,"parent")),g.indexOf("{")!=-1){var h=getSelectedRowData(a.grid.type,a.grid.id);g=replaceUrlParamValueByBrace(appendSourceUrlParam(g),h)}e.dialog({href:g}),e.dialog("open")}else e.dialog("open")}}function openDialogAndloadDataByUrl(a){var b=getSelectedRowData(a.grid.type,a.grid.id);if(!b)return void $.messager.alert(topJUI.language.message.title.operationTips,topJUI.language.message.msg.selectSelfGrid,topJUI.language.message.icon.warning);if(!a.dialog.beforeOpenCheckUrl||beforeOpenCheck(replaceUrlParamValueByBrace(a.dialog.beforeOpenCheckUrl,b))){var c=$("#"+a.dialog.id);c.dialog({width:a.dialog.width,height:a.dialog.height,maximized:a.dialog.maximized,maximizable:a.dialog.maximizable,left:a.dialog.leftMargin,top:a.dialog.topMargin,buttons:a.dialog.buttons});var d=a.dialog.href;if(a.dialog.href.indexOf("{")!=-1){var e=replaceUrlParamValueByBrace(appendSourceUrlParam(d),b);c.dialog({href:e}),c.dialog("open")}else c.dialog("open")}}function dialogHandler(a){authCheck(a)&&("loadData"==a.component?editHandler(a):"loadParentData"==a.action?addChildHandler(a):addHandler(a))}function addHandler(a){var b=(getUrl("controller"),{gridId:"datagrid"});a=$.extend(b,a);var c=$("#"+a.dialogId);c.dialog({iconCls:"icon-add",toolbar:"#"+a.dialogId+"-toolbar",buttons:"#"+a.dialogId+"-buttons"}),void 0!=a.dialogHref&&c.dialog("refresh",a.dialogHref),c.dialog("open")}function authCheck(a){var b=!1;return $.ajax({type:"post",url:ctx+"/system/authAccess/getAuthByRoleIdAndUrl",data:{url:a},async:!1,success:function(a){if(0==a){var c={title:topJUI.language.message.title.operationTips,msg:topJUI.language.message.msg.permissionDenied};$.messager.alert(c),b=!1}else b=!0}}),b}function beforeOpenCheck(a){var b=!1;return $.ajax({type:"get",url:a,async:!1,success:function(a){if(300==a.statusCode){var c={title:topJUI.language.message.title.operationTips,msg:a.message};$.messager.alert(c),b=!1}else b=!0}}),b}function addChildHandler(a){var b=$("#"+a.parentGridId).treegrid("getSelected")?$("#"+a.parentGridId).treegrid("getSelected"):$("#"+a.parentGridId).datagrid("getSelected");if(b){var c=getUrl("controller"),d={gridId:"datagrid",dialogHref:a.dialogHref?a.dialogHref:c+"edit"};a=$.extend(d,a);var e=$("#"+a.dialogId);e.dialog({iconCls:"icon-add",toolbar:"#"+a.dialogId+"-toolbar",buttons:"#"+a.dialogId+"-buttons"}),void 0!=a.dialogHref&&e.dialog("refresh",a.dialogHref),e.dialog("open"),setTimeout(function(){getTabWindow().$("#"+a.dialogId+" iframe").each(function(a){this.contentWindow.document.body.innerHTML=""});var c={};if(a.gridParam)for(var d=a.gridParam.split(","),f=0;f<d.length;f++)c[d[f]]=b[d[f]];c.puuid=b.uuid,e.form("load",c)},500)}else $.messager.alert(topJUI.language.message.title.operationTips,topJUI.language.message.msg.selectParentGrid,topJUI.language.message.icon.warning)}function editHandler(a){var b=getUrl("controller"),c={gridId:"datagrid",dialogHref:a.dialogHref?a.dialogHref:b+"edit",dialogUrl:a.dialogUrl?a.dialogUrl:b+"getDetailByUuid?uuid={uuid}"};a=$.extend(c,a),loadDialogData(a)}function getCheckedRowsData(a,b){return $("#"+b).treegrid("getChecked")}function getSelectedRowData(a,b){return getRowsDataBySelected(a,b,!1)}function getSelectedRowsData(a,b){return getRowsDataBySelected(a,b,!0)}function getRowsDataBySelected(a,b,c){var d=c?$("#"+b).datagrid("getSelections"):$("#"+b).datagrid("getSelected");return d}function getRowsDataBySelected2(a,b){var c,d;return"object"==typeof a.parentGrid?(d=a.parentGrid.id,"datagrid"==a.parentGrid.type?c=b?$("#"+d).datagrid("getSelections"):$("#"+d).datagrid("getSelected"):"treegrid"==a.parentGrid.type&&(c=b?$("#"+d).treegrid("getSelections"):$("#"+d).treegrid("getSelected"))):"object"==typeof a.grid&&(d=a.grid.id,"datagrid"==a.grid.type?c=b?$("#"+d).datagrid("getSelections"):$("#"+d).datagrid("getSelected"):"treegrid"==a.grid.type&&(c=b?$("#"+d).treegrid("getSelections"):$("#"+d).treegrid("getSelected"))),c}function refreshGrids(a){if("object"==typeof a)for(var b=0;b<a.length;b++){var c=a[b];!function(a){setTimeout(function(){refreshGrid(c.type,c.id,c.clearQueryParams)},100*a)}(b)}}function refreshGrid(a,b,c){"datagrid"==a?(1==c&&$("#"+b).datagrid({queryParams:{clearQueryParams:""}}),$("#"+b).datagrid("reload"),$("#"+b).datagrid("unselectAll")):"treegrid"==a&&($("#"+b).treegrid("reload"),$("#"+b).treegrid("unselectAll"))}function doAjaxHandler(a){var b={gridId:"datagrid",comfirmMsg:"确定要执行该操作吗？"};if(a=$.extend(b,a),authCheck(a.url)){if(a.url=appendSourceUrlParam(a.url),a.url.indexOf("{parent")!=-1){var c=getSelectedRowData(a.parentGrid.type,a.parentGrid.id);if(!c)return void $.messager.alert(topJUI.language.message.title.operationTips,topJUI.language.message.msg.selectParentGrid,topJUI.language.message.icon.warning);a.url=replaceUrlParamValueByBrace(a.url,c,"parent")}var d=getCheckedRowsData(a.grid.type,a.grid.id);if(0==d.length)return void $.messager.alert(topJUI.language.message.title.operationTips,topJUI.language.message.msg.checkSelfGrid,topJUI.language.message.icon.warning);a.url=replaceUrlParamValueByBrace(a.url,d),$.messager.confirm(topJUI.language.message.title.confirmTips,a.comfirmMsg,function(b){void 0==a.grid.param&&(a.grid.param={uuid:"uuid"}),a.ajaxData=convertParamObj2ObjData(a.grid.param,d),b&&doAjax(a)&&refreshGrid(a.grid.type,a.grid.id)})}}function deleteHandler(a){var b=a.url?a.url:getUrl("controller")+"delete";if(authCheck(b)){var c={gridId:"datagrid",url:a.url?appendSourceUrlParam(a.url):getUrl("controller")+"delete"+location.search};a=$.extend(c,a);var d=getCheckedRowsData(a.grid.type,a.grid.id);return 0==d.length?void $.messager.alert(topJUI.language.message.title.operationTips,topJUI.language.message.msg.checkSelfGrid,topJUI.language.message.icon.warning):void $.messager.confirm(topJUI.language.message.title.confirmTips,topJUI.language.message.msg.confirmDelete,function(b){b&&(a.ajaxData={uuid:getMultiRowsFieldValue(d,"uuid"),uuids:getMultiRowsFieldValue(d,"uuid")},doAjax(a)&&refreshGrid(a.grid.type,a.grid.id))})}}function filterHandler(a){var b;"object"==typeof a.grid&&(a.filterOption=[],"datagrid"==a.grid.type?(b=a.grid.id,$(".datagrid-filter-row").length>0?$("#"+b).datagrid("disableFilter",a.filterOption):$("#"+b).datagrid("enableFilter",a.filterOption)):"treegrid"==a.grid.type&&(b=a.grid.id,$(".datagrid-filter-row").length>0?$("#"+b).treegrid("disableFilter",a.filterOption):$("#"+b).treegrid("enableFilter",a.filterOption)))}function searchHandler(a){if("object"==typeof a.grid){getColumnsNameAndField(a.grid.type,a.grid.id);var b=$("#advanceSearchDialog");b.dialog({title:"高级查询",iconCls:"icon-find",toolbar:"#searchHandler-toolbar",buttons:"#searchHandler-buttons"}),b.dialog("open")}}function importHandler(a){if("object"==typeof a.grid){getColumnsNameAndField(a.grid.type,a.grid.id);var b=$("#importExcelDialog");b.dialog({title:"导入Excel数据",iconCls:"icon-find",toolbar:"#importDialog-toolbar",buttons:"#importDialog-buttons"}),b.dialog("open")}}function getColumnsNameAndField(a,b){var c=[],d=[],e=[],f=[];if("datagrid"==a){c=$("#"+b).datagrid("getColumnFields",!0),d=$("#"+b).datagrid("getColumnFields"),e=c.concat(d);for(var g=0;g<e.length;g++){var h=$("#"+b).datagrid("getColumnOption",e[g]);f.push(h.title)}}else if("treegrid"==a){c=$("#"+b).treegrid("getColumnFields",!0),d=$("#"+b).treegrid("getColumnFields"),e=c.concat(d);for(var i=0;i<e.length;i++){var h=$("#"+b).treegrid("getColumnOption",e[i]);f.push(h.title)}}var j=f.join(",").replace("UUID,","").replace(/,操作/g,"").replace(/操作,/g,""),k=e.join(",").replace("UUID,","").replace("uuid,","").replace(/,handle/g,"").replace(/handle,/g,"");$.cookie("gridId",b),$.cookie("gridType",a),$.cookie("colNameStr",j),$.cookie("fieldNameStr",k)}function exportHandler(a){var b=getUrl("controller"),c={gridId:"datagrid",url:"/system/index/requestSuccess",excelTitle:parent.$("#index_tabs").tabs("getSelected").panel("options").title+"_导出数据_"+getCurrentDatetime("YmdHis"),exportUrl:a.exportUrl?a.exportUrl:b+"exportExcel"};if(a=$.extend(c,a),authCheck(a.exportUrl)){var d,e,f,g,h,i=[],j=[];if("object"==typeof a.grid)if(d=a.grid.id,"datagrid"==a.grid.type){e=$("#"+d).datagrid("getColumnFields",!0),f=$("#"+d).datagrid("getColumnFields"),g=e.concat(f);for(var k=0;k<g.length;k++)h=$("#"+d).datagrid("getColumnOption",g[k]),i.push(h.title),1==h.hidden||1==h.checkbox?j.push(!0):j.push(!1)}else if("treegrid"==a.grid.type){e=$("#"+d).treegrid("getColumnFields",!0),f=$("#"+d).treegrid("getColumnFields"),g=e.concat(f);for(var l=0;l<g.length;l++)h=$("#"+d).treegrid("getColumnOption",g[l]),i.push(h.title),1==h.hidden||1==h.checkbox?j.push(!0):j.push(!1)}for(var m=0;m<j.length;m++)j[m]&&(i.splice(m,1),g.splice(m,1),j.splice(m,1),m--);var n=i.join(",").replace(/,操作/g,"").replace(/操作,/g,""),o=g.join(",").replace(/,handle/g,"").replace(/handle,/g,"");a.ajaxData={excelTitle:a.excelTitle,colName:n,fieldName:o},doAjax(a)&&(window.location.href=a.exportUrl+"?excelTitle="+a.excelTitle+"&colName="+n+"&fieldName="+o)}}function redoHandler(){$(options.gridId).datagrid("rejectChanges"),$(options.gridId).datagrid("unselectAll")}function doAjax(a){var b=!1,c={};return a=$.extend(c,a),$.ajax({url:a.url,type:"post",data:a.ajaxData,dataType:"json",async:!1,contentType:"application/x-www-form-urlencoded;charset=utf-8",beforeSend:function(){$.messager.progress({text:"正在操作..."})},success:function(c,d,e){$.messager.progress("close"),showMessage(c),refreshGrids(a.reload),b=1==c.statusCode||100==c.statusCode||200==c.statusCode}}),b}function setDialogHrefKeyValue(a,b,c){var d=b.split(","),e=c.split(","),f=$(a).dialog("options").href,g="";for(i=0;i<d.length;i++)f.indexOf("?")>0?f.indexOf(d[i]+"="+e[i])==-1&&(g+="&"+d[i]+"="+e[i]):0==i?g="?"+d[i]+"="+e[i]:g+="&"+d[i]+"="+e[i];$(a).dialog("options").href=f+g}function clearDialogHrefKeyValue(a,b){var c=b.split(","),d=$(a).dialog("options").href;if(d.indexOf("?")>0){var e="",f=d.substring(0,d.indexOf("?")+1),g=d.substring(d.indexOf("?")+1),h=g.split("&");for(i=0;i<h.length;i++)for(j=0;j<c.length;j++)h[i].indexOf(c[j]+"=")>=0&&h.remove(i);1==h.length?e=h[0]:h.length>1&&(e=h.join("&"));var k="";k=f+e;var l=k.substring(k.length-1);"?"==l&&(k=k.substring(0,k.length-1))}else k=d;$(a).dialog("options").href=k}function msgFn(a){var b={},c="";"object"==typeof a?(c=a.code,b={title:a.title,msg:a.message}):(c=a,b=1==a?{title:"温馨提示",msg:"操作成功"}:{title:"温馨提示",msg:"操作失败！未知错误，请重试！"}),!(1!=c&&100!=c&&200!=c||1!=c&&200!=c)?$.messager.show(b):$.messager.alert(b)}function showMessage(a){var b={},c="";"object"==typeof a?(c=a.statusCode,b={title:a.title,msg:a.message}):(c=a,b=1==a?{title:"操作提示",msg:"操作成功"}:{title:"操作提示",msg:"操作失败！"}),!(1!=c&&100!=c&&200!=c||1!=c&&200!=c)?(b.timeout=1e3,$.messager.show(b)):$.messager.alert(b)}function replaceUrlParamValueByBrace(a,b,c){var d=a;if(a&&a.indexOf("{")>=0){var e=isMultiObj(b)?b[0]:b,f=isNull(c)?"":c+".",g=new RegExp("{"+f+"(.*?)}","g"),h=a.match(g);if(h.length>0)for(var i=0;i<h.length;i++){var j=h[i].replace("{"+f,"").replace("}","");d="multiple"==c?d.replace(h[i],getMultiRowsFieldValue(b,j)):d.replace(h[i],e[j])}}return d}function convertParamValue2Object(a,b,c){var d=a;if(a&&a.indexOf("{")>=0){var e={},f=isMultiObj(b)?b[0]:b,g=isNull(c)?"":c+".",h=new RegExp("{"+g+"(.*?)}","g"),i=a.match(h);if(i.length>0)for(var j=0;j<i.length;j++){var k=i[j].replace("{"+g,"").replace("}","");"multiple"==c?e[k]=d.replace(i[j],getMultiRowsFieldValue(b,k)):e[k]=d.replace(i[j],f[k])}}return e}function convertParamObj2ObjData(a,b){var c,d,e={};for(c in a)d=a[c],isMultiObj(b)?e[c]=getMultiRowsFieldValue(b,d):e[c]="'"+b[d]+"'";return e}function getMultiRowsFieldValue(a,b){for(var c=[],d=0;d<a.length;d++)c.push("'"+a[d][b]+"'");return c.join(",")}function selectAllOptions(a){$(a+" option").attr("selected",!0)}function executeCallBackFun(functionStr,options){if(void 0!=functionStr){for(var handlerBeforeArr=functionStr.split("|"),handlerBeforeParamsArr=handlerBeforeArr[1].split(","),handlerBeforeParams="",h=0;h<handlerBeforeParamsArr.length;h++)handlerBeforeParams+=handlerBeforeParamsArr[h].indexOf("options.")>-1?handlerBeforeParamsArr[h]+",":'"'+handlerBeforeParamsArr[h]+'",';eval(handlerBeforeArr[0]+"("+handlerBeforeParams.substr(0,handlerBeforeParams.length-1)+")")}}function isMultiArr(a){if(!a)return!1;for(var b=0;b<a.length;b++)return a[b]instanceof Array}function isMultiObj(a){if(!a)return!1;for(var b=0;b<a.length;b++)return"object"==typeof a[b]}function bytesToSize(a,b){if(null==b&&(b=2),0===a)return"0 B";var c=1024,d=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],e=Math.floor(Math.log(a)/Math.log(c));return(a/Math.pow(c,e)).toFixed(b)+" "+d[e]}function appendUrlParam(a,b){return a.indexOf("?")==-1?a+"?"+b:a+"&"+b}function appendSourceUrlParam(a){return a.indexOf("?")==-1?a+location.search:a+location.search.replace("?","&")}function getCurrentDatetime(a){var b=new Date;return timestamp2Datetime(b,a)}function timestamp2Datetime(a,b){var c,d=new Date(a),e=d.getFullYear(),f=d.getMonth()+1<10?"0"+(d.getMonth()+1):d.getMonth()+1,g=d.getDate()<10?"0"+d.getDate():d.getDate(),h=d.getHours()<10?"0"+d.getHours():d.getHours(),i=d.getMinutes()<10?"0"+d.getMinutes():d.getMinutes(),j=d.getSeconds()<10?"0"+d.getSeconds():d.getSeconds();return c="YmdHis"==b?e+""+f+g+h+i+j:"Y-m-d H:i:s"==b?e+"-"+f+"-"+g+" "+h+":"+i+":"+j:"Y-m-d"==b?e+"-"+f+"-"+g:e+"-"+f+"-"+g+" "+h+":"+i}function getUrl(a){var b=window.location.pathname;return"controller"==a?url=b.substring(0,b.lastIndexOf("/")+1):url=b,url}function getOptionsJson(a){var b=a.data();return b.options&&(b=0==b.options.indexOf("{")?$.parseJSON(b.options.replace(/'/g,'"')):strToJson("{"+b.options.replace(/'/g,'"')+"}")),b}function setFormElementId(a,b){return void 0==b.id?(b.id=a[0].name,a.attr("id",a[0].name)):a.attr("id",b.id),b}function convertDateToFullDate(a){return(a<10?"0":"")+a}function isNull(a){return""==a||void 0==a||null==a}function getSelectedRowJson(a,b){var c={};if(a)for(var d=a.split(","),e=0;e<d.length;e++)if(d[e].indexOf(":")==-1)c[d[e]]=b[d[e]];else{var f=d[e].split(":");c[f[0]]=b[f[1]]}return c}function strToJson(str){var json=eval("("+str+")");return json}function jsonLength(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c}!function(a){a.fn.iCombotree=function(b){var c={combotreeId:this.selector,url:ctx+"/system/codeItem/getListByCodesetidAndLevelid?codeSetId={codeSetId}&levelId={levelId}",expandUrl:ctx+"/system/codeItem/getListByPid?pid={pid}",getFatherIdsUrl:"",width:153,height:30,required:!1,lines:!0,multiple:!1,checkbox:!0,onlyLeafCheck:!1,editable:!1,readonly:!1,animate:!0,expandAll:!1,onBeforeSelect:function(c){if(b.onlyLeafCheck){var d=a(this).tree("isLeaf",c.target);if(!d)return a.messager.alert("提示操作！","请展开选择子节点！","warning"),!1}}},b=a.extend(c,b);b.url.indexOf("codeSetId")==-1?b.url.indexOf("?")==-1?b.url=b.url+"?codeSetId="+b.codeSetId+"&levelId="+b.levelId:b.url=b.url+"&codeSetId="+b.codeSetId+"&levelId="+b.levelId:b.url=b.url.replace("{codeSetId}",b.codeSetId).replace("{levelId}",b.levelId),""==b.combotreeId&&(b.combotreeId=a(this).context),$combotreeObj=a(this),$combotreeObj.combotree({url:b.url,width:b.width,height:b.height,required:b.required,lines:b.lines,multiple:b.multiple,checkbox:b.checkbox,onlyLeafCheck:b.onlyLeafCheck,editable:b.editable,readonly:b.readonly,animate:b.animate,onBeforeExpand:function(c,d){a(this).tree("options").url=replaceUrlParamValueByBrace(b.expandUrl,c)},onBeforeSelect:b.onBeforeSelect,onLoadSuccess:function(c,d){var e=a(b.combotreeId).combotree("tree");e.tree("expand",e.tree("getRoot").target),b.expandAll&&e.tree("expandAll"),b.getFatherIdsUrl&&setTimeout(function(){var c=e.tree("getSelected"),d={id:a(b.combotreeId).combotree("getValue")};if(void 0==c&&""!=d.id){var f;a.ajax({type:"POST",url:replaceUrlParamValueByBrace(b.getFatherIdsUrl,d),success:function(c){var d=c.split(",");for(i=d.length-1;i>=0;i--)f=a(b.combotreeId).combotree("tree").tree("find",d[i].replace(/'/g,"")),f&&a(b.combotreeId).combotree("tree").tree("expand",f.target)}}),a(b.combotreeId).combotree("setValue",d.id)}},200)},onSelect:function(a){if(b.param){var c=$combotreeObj.closest("form"),d=getSelectedRowJson(b.param,a);getTabWindow().$("#"+c.attr("id")).form("load",d)}},onShowPanel:function(){},onChange:b.onChange})}}(jQuery),addParentTab=function(a){var b,c;if("object"==typeof a.grid){if(1==a.grid.checkboxSelect){var d=getCheckedRowsData(a.grid.type,a.grid.id);if(0==d.length)return void $.messager.alert(topJUI.language.message.title.operationTips,topJUI.language.message.msg.checkSelfGrid,topJUI.language.message.icon.warning);b=d[0].UUID?a.tab.href.indexOf("?")>=0?a.tab.href+"&UUID="+getMultiRowsFieldValue(d,"UUID"):a.tab.href+"?UUID="+getMultiRowsFieldValue(d,"UUID"):a.tab.href.indexOf("?")>=0?a.tab.href+"&uuid="+getMultiRowsFieldValue(d,"uuid"):a.tab.href+"?uuid="+getMultiRowsFieldValue(d,"uuid")}else{var e=getSelectedRowData(a.grid.type,a.grid.id);if(!e)return void $.messager.alert(topJUI.language.message.title.operationTips,topJUI.language.message.msg.selectSelfGrid,topJUI.language.message.icon.warning);b=replaceUrlParamValueByBrace(a.tab.href,e)}c=a.tab.title}else b=a.href,c=a.title;var f='<iframe src="'+b+'" frameborder="0" style="border:0;width:100%;height:99.5%;"></iframe>';parent.$("#index_tabs").tabs("add",{title:c,content:f,closable:!0,iconCls:"icon-page"})},openWindow=function(a){var b;if("object"==typeof a.grid)if(1==a.grid.checkboxSelect){var c=getCheckedRowsData(a.grid.type,a.grid.id);if(0==c.length)return void $.messager.alert(topJUI.language.message.title.operationTips,topJUI.language.message.msg.checkSelfGrid,topJUI.language.message.icon.warning)}else{var d=getSelectedRowData(a.grid.type,a.grid.id);if(!d)return void $.messager.alert(topJUI.language.message.title.operationTips,topJUI.language.message.msg.selectSelfGrid,topJUI.language.message.icon.warning);b=replaceUrlParamValueByBrace(a.href,d)}else b=a.href;window.open(b)},openDialog=function(a){var b={dialogId:"testDialog",title:"新增数据",href:"",url:"",width:600,height:400,btnText:"新增"};a=$.extend(b,a),$("#"+a.dialogId).dialog({title:a.title,href:a.href,width:a.width,height:a.height,buttons:[{text:a.btnText,iconCls:"icon-add",handler:function(){if($(this).form("validate")){var b=$("#"+a.dialogId).serialize();$.ajax({url:a.url,type:"post",data:b,beforeSend:function(){$.messager.progress({text:"正在操作..."})},success:function(a,b,c){$.messager.progress("close"),msgFn(a)}})}}},{text:"取消",iconCls:"icon-cancel",handler:function(){$("#"+a.dialogId).dialog("close").form("reset")}}],onLoad:function(){$(this).trigger(topJUI.eventType.initUI.form)}})},$.fn.serializeObject=function(){var a={},b=this.serializeArray();return $.each(b,function(){void 0!==a[this.name]?(a[this.name].push||(a[this.name]=[a[this.name]]),a[this.name].push(this.value||"")):a[this.name]=this.value||""}),a};var topJUI={eventType:{initUI:{base:"topjui.initUI.base",dialog:"topjui.initUI.dialog",base2:"topjui.initUI.base2",echarts:"topjui.initUI.echarts",form:"topjui.initUI.form",advanceSearchForm:"topjui.initUI.advanceSearchForm",importExcelForm:"topjui.initUI.importExcelForm"},beforeInitUI:"topjui.beforeInitUI",afterInitUI:"topjui.afterInitUI",ajaxStatus:"topjui.ajaxStatus",resizeGrid:"topjui.resizeGrid",beforeAjaxLoad:"topjui.beforeAjaxLoad",beforeLoadNavtab:"topjui.beforeLoadNavtab",beforeLoadDialog:"topjui.beforeLoadDialog",afterLoadNavtab:"topjui.afterLoadNavtab",afterLoadDialog:"topjui.afterLoadDialog",beforeCloseNavtab:"topjui.beforeCloseNavtab",beforeCloseDialog:"topjui.beforeCloseDialog",afterCloseNavtab:"topjui.afterCloseNavtab",afterCloseDialog:"topjui.afterCloseDialog"},language:{message:{title:{operationTips:"操作提示",confirmTips:"确认提示"},msg:{success:"操作成功",failed:"操作失败",error:"未知错误",checkSelfGrid:"请先勾选中要操作的数据前的复选框",selectSelfGrid:"请先选中要操作的数据",selectParentGrid:"请先选中主表中要操作的一条数据",permissionDenied:"对不起，你没有操作权限",confirmDelete:"你确定要删除所选的数据吗？"},icon:{error:"error",question:"question",info:"info",warning:"warning"}}}};!function(a){a.fn.iDatagrid=function(b){var c={datagridId:this.selector,width:"100%",height:"100%",autoRowHeight:!1,nowrap:!0,fit:!0,fitColumns:!1,border:!1,striped:!0,singleSelect:!0,url:"",toolbar:this.selector+"-toolbar",columns:[[{field:"uuid",title:"UUID",align:"center"},{field:"title",title:"标题",align:"left"},{field:"creator",title:"发布人",align:"center"},{field:"createTime",title:"发布时间",align:"center"}]],sortName:"createTime",sortOrder:"desc",addButton:!0,editButton:!0,deleteButton:!0,searchButton:!0,addDialogTitle:"新增",editDialogTitle:"编辑",loadMsg:"数据加载中,请稍后...",rownumbers:!0,pagination:!0,pageNumber:1,pageSize:20,pageList:[20,30,40,50,100,200],editable:!0,queryFormId:"",queryAction:"",infoFormId:"",infoAddAction:"",infoUpdateAction:"",infoDlgDivId:"",deleteAction:"",deleteMsg:"",moveDlgDivId:"",moveFormId:"",moveTreeId:"",queryParams:{},queryParamsVCN:{},checkOnSelect:!1,selectOnCheck:!1,kindEditor:[],addDialogId:"#editDialog",editDialogId:"#editDialog",gridParam:"uuid"},b=a.extend(c,b),d=getUrl("controller");b.url=b.url?b.url:d+"getPageSetData",b.getDetailUrl=b.getDetailUrl?b.getDetailUrl:d+"getDetailByUuid",b.addDialogHref=b.addDialogHref?b.addDialogHref:d+"add",b.saveUrl=b.saveUrl?b.saveUrl:d+"save",b.editDialogHref=b.editDialogHref?b.editDialogHref:d+"edit",b.updateUrl=b.updateUrl?b.updateUrl:d+"update",b.deleteUrl=b.deleteUrl?b.deleteUrl:d+"delete",a(this).datagrid({filterBtnIconCls:"icon-filter",remoteFilter:!0,width:b.width,height:b.height,autoRowHeight:b.autoRowHeight,nowrap:b.nowrap,striped:b.striped,singleSelect:b.singleSelect,url:appendSourceUrlParam(b.url),toolbar:b.toolbar,loadMsg:b.loadMsg,rownumbers:b.rownumbers,pagination:b.pagination,paginPosition:"bottom",pageNumber:b.pageNumber,pageSize:b.pageSize,pageList:b.pageList,frozenColumns:b.frozenColumns,columns:b.columns,sortName:b.sortName,sortOrder:b.sortOrder,fit:b.fit,fitColumns:b.fitColumns,border:b.border,checkOnSelect:b.checkOnSelect,selectOnCheck:b.selectOnCheck,onBeforeLoad:function(a){},onLoadSuccess:function(){if("object"==typeof b.childGrid)for(var c=b.childGrid.grid,d=0;d<c.length;d++){var e=c[d].syncReload;if(e){var f=a("#"+c[d].id);"datagrid"==c[d].type?f.datagrid("load"):"treegrid"==c[d].type&&f.treegrid("load")}}},onClickRow:function(c,d){if("object"==typeof b.childGrid){var e={};e=getSelectedRowJson(b.childGrid.param,d);for(var f=b.childGrid.grid,g=0;g<f.length;g++)!function(b){setTimeout(function(){var c=a("#"+f[b].id);if("datagrid"==f[b].type){var d=c.datagrid("options").queryParams;c.datagrid("options").queryParams=a.extend({},d,e),c.datagrid("load")}else if("treegrid"==f[b].type){var d=c.treegrid("options").queryParams;c.treegrid("options").queryParams=a.extend({},d,e),c.treegrid("load")}else if("panel"==f[b].type){var g=replaceUrlParamValueByBrace(f[b].href,e);c.panel("refresh",g)}},100*b)}(g)}if("object"==typeof b.childTabs){var h=a("#"+b.childTabs.id),i=h.tabs("options"),c=h.tabs("getTabIndex",h.tabs("getSelected")),j=i.component,k=a("#"+j[c].id),e={};if(e=getSelectedRowJson(b.childTabs.param,d),"datagrid"==j[c].type){var l=k.datagrid("options").queryParams;k.datagrid("options").queryParams=a.extend({},l,e),k.datagrid("load")}else if("treegrid"==j[c].type){var l=k.treegrid("options").queryParams;k.treegrid("options").queryParams=a.extend({},l,e),k.treegrid("load")}else if("panel"==j[c].type){var m=k.panel("options"),n=replaceUrlParamValueByBrace(m.dynamicHref,d);k.panel("refresh",n)}}}})};var b=function(b,c){b.preventDefault();var d=a(this),e=this.headerContextMenu,f="tree-checkbox1",g="tree-checkbox0";if(!e){for(var h=a('<div style="width:150px;"></div>').appendTo("body"),i=d.datagrid("getColumnFields"),j=0;j<i.length;j++){var k=d.datagrid("getColumnOption",i[j]);k.hidden?a('<div iconCls="'+g+'" field="'+i[j]+'"/>').html(k.title).appendTo(h):a('<div iconCls="'+f+'" field="'+i[j]+'"/>').html(k.title).appendTo(h)}e=this.headerContextMenu=h.menu({onClick:function(b){var c=a(b.target).attr("field");b.iconCls==f?(d.datagrid("hideColumn",c),a(this).menu("setIcon",{target:b.target,iconCls:g})):(d.datagrid("showColumn",c),a(this).menu("setIcon",{target:b.target,iconCls:f})),e.menu("show")}})}e.menu("show",{left:b.pageX,top:b.pageY})};a.fn.datagrid.defaults.onHeaderContextMenu=b,a.fn.treegrid.defaults.onHeaderContextMenu=b}(jQuery),function(a){a.fn.iDialog=function(b){var c={currentDialogId:this.selector,width:650,height:400,title:"编辑",modal:!0,closed:!0,iconCls:"icon-save",collapsible:!0,maximizable:!0,minimizable:!1,maximized:!1,resizable:!0,openAnimation:"show",openDuration:100,closeAnimation:"show",closeDuration:400,toolbar:this.selector+"-toolbar",buttons:this.selector+"-buttons",postfix:"Edit",combotreeFields:"",refreshTreeId:""},b=a.extend(c,b),d=getUrl("controller");b.href=b.href?b.href+location.search:d+"edit"+location.search;var e=a("#"+b.id);a(this).dialog({width:b.width,height:b.height,title:b.title,modal:b.modal,closed:b.closed,iconCls:b.iconCls,href:b.href,collapsible:b.collapsible,maximizable:b.maximizable,minimizable:b.minimizable,maximized:b.maximized,resizable:b.resizable,openAnimation:b.openAnimation,openDuration:b.openDuration,closeAnimation:b.closeAnimation,closeDuration:b.closeDuration,zIndex:10,toolbar:b.toolbar,buttons:b.buttons,onBeforeOpen:function(){},onLoad:function(){if(a(this).trigger(topJUI.eventType.initUI.form),b.url.length>1){var c=getSelectedRowData(b.grid.type,b.grid.id),d=replaceUrlParamValueByBrace(b.url,c);a.getJSON(d,function(a){if(e.form("load",a),"string"==typeof b.editor||"object"==typeof b.editor){if("string"==typeof b.editor){var c=[],d=[];c=b.editor.replace(/'/g,'"').split(",");for(var f=0;f<c.length;f++)d.push(strToJson(c[f]))}else d=b.editor;for(var f=0;f<d.length;f++){var g=d[f].type,h=d[f].id,i=d[f].field;"kindeditor"==g?getTabWindow().$("iframe").each(function(b){
this.contentWindow.document.body.innerHTML=html_decode(a[i])}):UE.getEditor(h).ready(function(){UE.getEditor(h).setContent(a[i])})}}})}if("object"==typeof b.parentGrid){var f=getSelectedRowData(b.parentGrid.type,b.parentGrid.id),g=getSelectedRowJson(b.parentGrid.param,f);e.form("load",g)}},onClose:function(){a(b.currentDialogId).form("clear")}})}}(jQuery),function(a){a.fn.iEdatagrid=function(b){var c={datagridId:this.selector,width:"100%",height:"100%",autoRowHeight:!1,nowrap:!0,fit:!0,fitColumns:!1,border:!1,striped:!0,singleSelect:!0,url:"",toolbar:this.selector+"-toolbar",columns:[[{field:"uuid",title:"UUID",align:"center"},{field:"title",title:"标题",align:"left"},{field:"creator",title:"发布人",align:"center"},{field:"createTime",title:"发布时间",align:"center"}]],sortName:"createTime",sortOrder:"desc",addButton:!0,editButton:!0,deleteButton:!0,searchButton:!0,addDialogTitle:"新增",editDialogTitle:"编辑",loadMsg:"数据加载中,请稍后...",rownumbers:!0,pagination:!0,pageNumber:1,pageSize:20,pageList:[10,20,30,40,50,100,200,300,400,500],editable:!0,queryFormId:"",queryAction:"",infoFormId:"",infoAddAction:"",infoUpdateAction:"",infoDlgDivId:"",deleteAction:"",deleteMsg:"",moveDlgDivId:"",moveFormId:"",moveTreeId:"",queryParams:{},queryParamsVCN:{},checkOnSelect:!1,selectOnCheck:!1,kindEditor:[],addDialogId:"#editDialog",editDialogId:"#editDialog",gridParam:"uuid"},b=a.extend(c,b),d=getUrl("controller");b.url=b.url?b.url:d+"getPageSetData",b.getDetailUrl=b.getDetailUrl?b.getDetailUrl:d+"getDetailByUuid",b.addDialogHref=b.addDialogHref?b.addDialogHref:d+"add",b.saveUrl=b.saveUrl?b.saveUrl:d+"save",b.editDialogHref=b.editDialogHref?b.editDialogHref:d+"edit",b.updateUrl=b.updateUrl?b.updateUrl:d+"update",b.destroyUrl=b.destroyUrl?b.destroyUrl:d+"delete",a(this).edatagrid({filterBtnIconCls:"icon-filter",remoteFilter:!0,width:b.width,height:b.height,autoRowHeight:b.autoRowHeight,nowrap:b.nowrap,striped:b.striped,singleSelect:b.singleSelect,url:appendSourceUrlParam(b.url),toolbar:b.toolbar,loadMsg:b.loadMsg,rownumbers:b.rownumbers,pagination:b.pagination,paginPosition:"bottom",pageNumber:b.pageNumber,pageSize:b.pageSize,pageList:b.pageList,frozenColumns:b.frozenColumns,columns:b.columns,sortName:b.sortName,sortOrder:b.sortOrder,fit:b.fit,fitColumns:b.fitColumns,border:b.border,checkOnSelect:b.checkOnSelect,selectOnCheck:b.selectOnCheck,saveUrl:b.saveUrl,updateUrl:b.updateUrl,destroyUrl:b.destroyUrl,onBeforeLoad:function(a){},onLoadSuccess:function(){},onClickRow:function(c,d){if("object"==typeof b.childGrid){var e={};e=getSelectedRowJson(b.childGrid.param,d);for(var f=b.childGrid.grid,g=0;g<f.length;g++)!function(b){setTimeout(function(){var c=a("#"+f[b].id);if("datagrid"==f[b].type){var d=c.datagrid("options").queryParams;c.datagrid("options").queryParams=a.extend({},d,e),c.datagrid("load")}else if("treegrid"==f[b].type){var d=c.treegrid("options").queryParams;c.treegrid("options").queryParams=a.extend({},d,e),c.treegrid("load")}else if("panel"==f[b].type){var g=replaceUrlParamValueByBrace(f[b].href,e);c.panel("refresh",g)}},100*b)}(g)}}})};var b=function(b,c){b.preventDefault();var d=a(this),e=this.headerContextMenu,f="tree-checkbox1",g="tree-checkbox0";if(!e){for(var h=a('<div style="width:150px;"></div>').appendTo("body"),i=d.datagrid("getColumnFields"),j=0;j<i.length;j++){var k=d.datagrid("getColumnOption",i[j]);k.hidden?a('<div iconCls="'+g+'" field="'+i[j]+'"/>').html(k.title).appendTo(h):a('<div iconCls="'+f+'" field="'+i[j]+'"/>').html(k.title).appendTo(h)}e=this.headerContextMenu=h.menu({onClick:function(b){var c=a(b.target).attr("field");b.iconCls==f?(d.datagrid("hideColumn",c),a(this).menu("setIcon",{target:b.target,iconCls:g})):(d.datagrid("showColumn",c),a(this).menu("setIcon",{target:b.target,iconCls:f})),e.menu("show")}})}e.menu("show",{left:b.pageX,top:b.pageY})};a.fn.datagrid.defaults.onHeaderContextMenu=b,a.fn.treegrid.defaults.onHeaderContextMenu=b}(jQuery),$.extend($.fn.datagrid.methods,{fixRownumber:function(a){return a.each(function(){var a=$(this).datagrid("getPanel"),b=$(".datagrid-cell-rownumber",a).last().clone();b.css({position:"absolute",left:-1e3}).appendTo("body");var c=b.width("auto").width();c>25?($(".datagrid-header-rownumber,.datagrid-cell-rownumber",a).width(c+5),$(this).datagrid("resize"),b.remove(),b=null):$(".datagrid-header-rownumber,.datagrid-cell-rownumber",a).removeAttr("style")})},addToolbarItem:function(jq,items){return jq.each(function(){var dpanel=$(this),toolbar=dpanel.children("div.datagrid-toolbar");toolbar.length||(toolbar=$('<div class="datagrid-toolbar"><table cellspacing="0" cellpadding="0"><tr></tr></table></div>').prependTo(dpanel),$(this).datagrid("resize"));for(var tr=toolbar.find("tr"),i=0;i<items.length;i++){var btn=items[i];if("-"==btn)$('<td><div class="datagrid-btn-separator"></div></td>').appendTo(tr);else{var td=$("<td></td>").appendTo(tr),b=$('<a href="javascript:void(0)"></a>').appendTo(td);b[0].onclick=eval(btn.handler||function(){}),b.linkbutton($.extend({},btn,{plain:!0}))}}})},removeToolbarItem:function(a,b){return a.each(function(){var a=$(this).datagrid("getPanel"),c=a.children("div.datagrid-toolbar"),d=null;"number"==typeof b?d=c.find("td").eq(b).find("span.l-btn-text"):"string"==typeof b&&(d=c.find("span.l-btn-text:contains('"+b+"')")),d&&d.length>0&&(d.closest("td").remove(),d=null)})}}),function(a){var b=new Date,c=b.getFullYear(),d=b.getMonth()+1,e=b.getDate(),f=b.getHours();b.getMinutes(),b.getSeconds();a.fn.iTextbox=function(b){var c={width:153,height:30,prompt:"",type:"text",multiline:!1,readonly:!1,disabled:!1,iconCls:"",buttonText:"",buttonIcon:"",required:!1,missingMessage:"必填"},b=a.extend(c,b);a(this).textbox({width:b.width,height:b.height,prompt:b.prompt,type:b.type,multiline:b.multiline,readonly:b.readonly,disabled:b.disabled,iconCls:b.iconCls,buttonText:b.buttonText,buttonIcon:b.buttonIcon,required:b.required,missingMessage:b.missingMessage,onChange:b.onChange,onClickButton:b.onClickButton})},a.fn.iFilebox=function(b){var c={width:450,height:30,prompt:"",type:"text",multiline:!1,readonly:!1,disabled:!1,iconCls:"",buttonText:"选择文件",buttonAlign:"right",required:!1,missingMessage:"必填",onChange:function(){}},b=a.extend(c,b);a(this).filebox({width:b.width,height:b.height,buttonText:b.buttonText,buttonAlign:b.buttonAlign})},a.fn.iNumberspinner=function(b){var g={min:0,max:1e4,width:153,height:30,editable:!0,defaultValueType:"",value:"",min:0,max:999999999,required:!1},b=a.extend(g,b);"currentYear"==b.defaultValueType?(b.value=c,b.min=1900,b.max=2200):"currentSeason"==b.defaultValueType?(1==d||2==d||3==d?b.value=1:4==d||5==d||6==d?b.value=2:7==d||8==d||9==d?b.value=3:10!=d&&11!=d&&12!=d||(b.value=4),b.min=1,b.max=4):"currentMonth"==b.defaultValueType?(b.value=d,b.min=1,b.max=12):"currentDay"==b.defaultValueType?(b.value=e,b.min=1,b.max=31):"currentHour"==b.defaultValueType&&(b.value=f,b.min=0,b.max=24),a(this).numberspinner({min:b.min,max:b.max,prompt:b.prompt,width:b.width,height:b.height,editable:b.editable,value:b.value,min:b.min,max:b.max,buttonText:"",required:b.required})},a.fn.iDatebox=function(b){var c={required:!1,editable:!0,width:153,height:30,formatter:function(a){var c=a.getFullYear(),d=a.getMonth()+1,e=a.getDate();return"YYYY"==b.pattern?c:"YYYY-mm"==b.pattern?c+"-"+convertDateToFullDate(d):c+"-"+convertDateToFullDate(d)+"-"+convertDateToFullDate(e)},parser:function(a){var b=Date.parse(a);return isNaN(b)?new Date:new Date(b)},value:""},b=a.extend(c,b);a(this).datebox({required:b.required,editable:b.editable,width:b.width,height:b.height,prompt:b.prompt,formatter:b.formatter,parser:b.parser,onSelect:function(a){}})},a.fn.iNumberbox=function(b){var c={width:153,height:30,min:0,precision:0,decimalSeparator:".",groupSeparator:",",required:!1,buttonText:""},b=a.extend(c,b);a(this).numberbox({width:b.width,height:b.height,min:b.min,prompt:b.prompt,precision:b.precision,decimalSeparator:b.decimalSeparator,groupSeparator:b.groupSeparator,prefix:b.prefix,buttonText:"",required:b.required})},a.fn.iLinkbutton=function(b){var c={iconCls:"icon-edit",plain:!1},b=a.extend(c,b);a(this).linkbutton(b)},a.fn.iMenubutton=function(b){var c={iconCls:"icon-save",hasDownArrow:!1},b=a.extend(c,b);getTabWindow().$(this).menubutton({iconCls:b.iconCls,hasDownArrow:b.hasDownArrow,menu:b.menu})},a.fn.iValidatebox=function(b){var c={required:!0,validType:"email"},b=a.extend(c,b);a(this).validatebox({required:b.required,validType:b.validType})},a.fn.iCombobox=function(b){var c={width:153,height:30,url:ctx+"/system/codeItem/getListByCodesetidAndLevelid?codeSetId={codeSetId}&levelId={levelId}",data:"",codeSetId:0,pid:0,valueField:"text",textField:"text",editable:!1,panelHeight:50,onSelect:g,formatter:h,required:!1},b=a.extend(c,b);b.data&&(b.url=""),b.codeSetId&&(b.url=b.url.replace("{codeSetId}",b.codeSetId).replace("{levelId}",b.levelId)),a(this).combobox({width:b.width,height:b.height,prompt:b.prompt,url:b.url,data:b.data,valueField:b.valueField,textField:b.textField,editable:b.editable,panelHeight:b.panelHeight,formatter:b.combobox_formatter,required:b.required,onShowPanel:function(){if(b.url.indexOf("{")>=0){var c=a(this).closest("form").serializeObject();a("#"+b.id).combobox("reload",replaceUrlParamValueByBrace(b.url,c))}},onChange:function(c,d){if("object"==typeof b.childCombobox){var e=appendUrlParam(b.childCombobox.url,"parentParam="+c);a("#"+b.childCombobox.id).combobox("reload",e)}},onSelect:function(c){var d=a(this).closest("form");if(b.param){var e=getSelectedRowJson(b.param,c);getTabWindow().$("#"+d.attr("id")).form("load",e)}}})};var g=function(a){},h=function(a){0==value};a.fn.iAutoComplete=function(b){var c={selector:this.selector,url:ctx+"/system/user/getListByUserName?userName=",valueField:"userNameId",textField:"userName",width:450,height:30,fieldId:"userNameId",required:!1},b=a.extend(c,b);a(this).combobox({valueField:b.valueField,textField:b.textField,width:b.width,height:b.height,prompt:b.prompt,required:b.required,onChange:function(c,d){null!=c&&a(this).combobox("reload",b.url+encodeURI(encodeURI(c)))},onSelect:function(c){a.messager.confirm("确认","你选择的人员是："+c.userName,function(d){if(d){var e=c.userName.indexOf("(cni23");a(b.selector).combobox("setValue",c.userName.substring(0,e)),a(b.selector).combobox("hidePanel"),a(b.fieldId).val(c.userNameId)}else a(b.selector).combobox("setValue","")})},onHidePanel:function(){""==a(b.fieldId).val()&&a(b.selector).combobox("setText","")}})},a.fn.iAutoComplete2=function(b){var c={comboboxId:this.selector,url:ctx+"/system/user/getListByUserName?userName=",valueField:"userNameId",textField:"userName",width:450,height:30,fieldId:"userNameId",required:!1,formatter:""},b=a.extend(c,b);""==b.comboboxId&&(b.comboboxId=a(this).context),$comboboxObj=a(this),a(this).combobox({valueField:b.valueField,textField:b.textField,width:b.width,height:b.height,prompt:b.prompt,required:b.required,formatter:b.formatter,onLoadSuccess:function(c,d){setTimeout(function(){a(b.comboboxId).combobox("getValue")},400)},onShowPanel:function(){a(this).combobox("reload",b.url)},onChange:function(c,d){null==c&&(c=a(b.comboboxId).combobox("getValue"));var e=b.url.match(/{([\s\S]*?)}/g),f=b.url;if(e.length>0)for(var g=0;g<e.length;g++)f=f.replace(e[g],encodeURI(encodeURI(c)));a(this).combobox("reload",f)},onSelect:function(c){if(a(b.comboboxId).combobox("hidePanel"),b.param){var d=$comboboxObj.closest("form"),e=getSelectedRowJson(b.param,c);getTabWindow().$("#"+d.attr("id")).form("load",e)}setTimeout(function(){a(b.comboboxId).combobox("setText",c[b.textField])},1e3)},onUnselect:function(c){setTimeout(function(){a(b.comboboxId).combobox("setValue",""),a(b.comboboxId).combobox("setText","")},400)},onHidePanel:function(){if(b.textField!=b.valueField){var c=a(b.comboboxId).combobox("getText"),d=a(b.comboboxId).combobox("getValue");c==d&&(a(b.comboboxId).combobox("setText",""),a(b.comboboxId).combobox("setValue",""))}}})}}(jQuery),$.getUrlParam=function(a){var b=new RegExp("(^|&)"+a+"=([^&]*)(&|$)"),c=window.location.search.substr(1).match(b);return null!=c?unescape(c[2]):null},$.getUrlStrParam=function(a,b){urlParam=a.substring(a.indexOf("?"));var c=new RegExp("(^|&)"+b+"=([^&]*)(&|$)"),d=urlParam.substr(1).match(c);return null!=d?unescape(d[2]):null},test=function(a){alert(a)},subString=function(a,b,c){return void 0!=a?a.substring(b,c):""},Array.prototype.indexOf=function(a){for(var b=0;b<this.length;b++)if(this[b]==a)return b;return-1},Array.prototype.remove=function(a){for(var b=this.indexOf(a);b>-1;)this.splice(b,1),b=this.indexOf(a)},function(a){a.fn.iMenu=function(b){function c(b,c){var d=a("#"+c).treegrid("getSelected");switch(b.name){case"add":a("#"+b.dialogId).dialog("open");for(var e=b.treegridParam.split(","),f={},g=0;g<e.length;g++)f[e[g]]=d[e[g]];return f.pid=d.id,setTimeout(function(){a("#"+b.dialogId).form("load",f)},100),!1;case"edit":return a("#"+b.dialogId).dialog("open"),setTimeout(function(){a("#"+b.dialogId).form("load",b.dialogUrl.replace("{uuid}",d.uuid))},100),!1;case"refresh":a("#"+c).treegrid("reload",d.id);break;case"remove":a.messager.confirm("提示","确定要删除吗？",function(b){b&&a.ajax({url:ctx+"/System/Menu/delete",type:"post",data:{uuids:"'"+d.uuid+"'"},beforeSend:function(){a.messager.progress({text:"正在操作..."})},success:function(b,e,f){a.messager.progress("close"),b>0?(a.messager.show({title:"提示",msg:"操作成功"}),a(c).treegrid("reload",d.pid)):a.messager.alert("操作失败！","未知错误或没有任何修改，请重试！","warning")}})})}}var d={menuId:this.selector,width:600,height:400,title:"修改管理",modal:!1,closed:!0,iconCls:"icon-save",collapsible:!0,maximizable:!0,minimizable:!1,maximized:!1,openAnimation:"show",openDuration:600,postfix:"Edit",combotreeFields:"",refreshTreeId:"",datagridId:"datagrid",treegridId:"treegrid",editDialogId:"editDialog"},b=a.extend(d,b);a(b.menuId).menu({onClick:function(d){var e,f;a(b.menuId+" .menu-item").each(function(b,c){e=getOptionsJson(a(this)),d.name==e.name&&(f=e)}),c(f,b.treegridId)}})}}(jQuery),+function(a){"use strict";a(document).on(topJUI.eventType.initUI.form,function(b){a('[data-toggle="topjui-textbox"]').each(function(b){var c=a(this),d=getOptionsJson(c);d.readonly?d.buttonText="只读":d.disabled&&(d.buttonText="禁止"),d=setFormElementId(c,d),c.iTextbox(d)}),a('[data-toggle="topjui-filebox"]').each(function(b){var c=a(this),d=getOptionsJson(c);d=setFormElementId(c,d),c.iFilebox(d)}),a('[data-toggle="topjui-numberspinner"]').each(function(b){var c=a(this),d=getOptionsJson(c);d=setFormElementId(c,d),c.iNumberspinner(d)}),a('[data-toggle="topjui-numberbox"]').each(function(b){var c=a(this),d=getOptionsJson(c);d=setFormElementId(c,d),c.iNumberbox(d)}),a('[data-toggle="topjui-datebox"]').each(function(b){var c=a(this),d=getOptionsJson(c);d=setFormElementId(c,d),c.iDatebox(d)}),a('[data-toggle="topjui-combobox"]').each(function(b){var c=a(this),d=getOptionsJson(c);d=setFormElementId(c,d),c.iCombobox(d)}),a('[data-toggle="topjui-combotree"]').each(function(b){var c=a(this),d=getOptionsJson(c);d=setFormElementId(c,d),c.iCombotree(d)}),a('[data-toggle="topjui-textarea"]').each(function(b){var c=a(this),d=getOptionsJson(c);d.multiline=!0,null==d.width&&(d.width=450),null==d.height&&(d.height=66),d=setFormElementId(c,d),c.iTextbox(d)}),a('[data-toggle="topjui-autocomplete"]').each(function(b){var c=a(this),d=getOptionsJson(c);d=setFormElementId(c,d),c.iAutoComplete2(d)}),a('[data-toggle="topjui-ueditor"]').each(function(b){var c=a(this),d=getOptionsJson(c);d=setFormElementId(c,d),UE.delEditor(d.id);var e=[["fullscreen","source","|","undo","redo","|","bold","italic","underline","fontborder","strikethrough","superscript","subscript","removeformat","|","formatmatch","autotypeset","blockquote","pasteplain","|","forecolor","backcolor","insertorderedlist","insertunorderedlist","lineheight","|","horizontal","spechars","map","paragraph","fontfamily","fontsize","insertcode","|","indent","justifyleft","justifycenter","justifyright","justifyjustify","|","link","unlink","|","emotion","attachment","simpleupload","insertimage","|","preview"]],f=[["fullscreen","source","undo","redo","bold","italic","underline","fontborder","strikethrough","superscript","subscript","insertunorderedlist","insertorderedlist","justifyleft","justifycenter","justifyright","justifyjustify","removeformat","simpleupload","snapscreen","emotion","attachment","link","unlink","indent","lineheight","autotypeset"]];UE.getEditor(d.id,{toolbars:"simple"==d.mode?f:e,initialFrameWidth:700,autoHeightEnabled:!0,autoFloatEnabled:!0,readonly:!!d.readonly})}),a('[data-toggle="topjui-ueupload"]').each(function(b){var c=a(this),d=getOptionsJson(c);d=setFormElementId(c,d);var e={width:450,buttonText:"选择图片",uploadType:"image",buttonIcon:"icon-picture_add"},d=a.extend(e,d),f=d.id+"Uploader";a("body").append('<script type="text/plain" id="'+f+'"></script>');var g=UE.getEditor(f,{toolbars:[["insertimage","attachment"]]});g.ready(function(){g.setDisabled(),g.hide();var b="afterConfirmUploadedFile",e="url";"image"==d.uploadType&&(b="afterConfirmUploadedImage",e="src"),g.addListener(b,function(b,c){a("#"+d.id).textbox("setText",c[0][e]),a("#"+d.id).textbox("setValue",c[0][e]),"src"==e&&a("#"+d.previewImageId).attr(e,c[0][e])}),d.onClickButton=function(){if("image"==d.uploadType){var a=g.getDialog("insertimage");a.open()}else{var b=g.getDialog("attachment");b.open()}},c.iTextbox(d)})}),a('[data-toggle="topjui-kindeditor"]').each(function(b){var c=a(this),d=getOptionsJson(c);d.items&&(d.items=d.items.replaceAll("'","").replaceAll(" ","").split(",")),d.afterUpload&&(d.afterUpload=d.afterUpload.toFunc()),d.afterSelectFile&&(d.afterSelectFile=d.afterSelectFile.toFunc()),d.confirmSelect&&(d.confirmSelect=d.confirmSelect.toFunc());var e={font:[],span:[".color",".background-color",".font-size",".font-family"],div:[".margin",".padding",".text-align"],table:["align","width"],"td,th":["align","valign","width","height","colspan","rowspan"],a:["href","target","name"],embed:["src","width","height","type","loop","autostart","quality",".width",".height","align","allowscriptaccess"],img:["src","width","height","border","alt","title","align",".width",".height",".border"],"p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6":["class","align",".text-align",".color",".font-weight",".font-style",".text-decoration",".vertical-align",".text-indent",".margin-left"],pre:["class"],hr:["class",".page-break-after"],"br,tbody,tr,strong,b,sub,sup,em,i,u,strike,s,del":[]};KindEditor.create(c,{module:d.module?d.module:"未设置",category:d.category?d.category:"default",width:d.width?d.width+"px":"700px",height:d.height?d.height+"px":"600px",pasteType:d.pasteType,minHeight:d.minHeight||150,autoHeightMode:d.autoHeight||!0,afterCreate:function(){},items:"simple"==d.model?["source","fontname","fontsize","|","forecolor","hilitecolor","bold","italic","underline","removeformat","|","justifyleft","justifycenter","justifyright","insertorderedlist","insertunorderedlist","|","emoticons","image","insertfile","link"]:KindEditor.options.items,uploadJson:d.uploadJson||ctx+"/system/attachment/kindeditorUpload",fileManagerJson:d.fileManagerJson||ctx+"/static/kindeditor/4.1.5/jsp/file_manager_json.jsp",allowFileManager:d.allowFileManager||!0,fillDescAfterUploadImage:d.fillDescAfterUploadImage||!0,afterUpload:d.afterUpload,afterSelectFile:d.afterSelectFile,X_afterSelect:d.confirmSelect,htmlTags:e,cssPath:[ctx+"/static/kindeditor/4.1.5/editor-content.css",ctx+"/static/kindeditor/4.1.5/plugins/code/prettify.css"],afterBlur:function(){this.sync()}})}),a('[data-toggle="topjui-upload"]').each(function(b){var c=a(this),d=getOptionsJson(c);setTimeout(function(){var b=d.url,e=b;if(d.url.indexOf("{")!=-1){var f=getSelectedRowData(d.grid.type,d.grid.id);e=replaceUrlParamValueByBrace(b,f)}var g=KindEditor.uploadbutton({button:KindEditor(c)[0],fieldName:"imgFile",url:e||ctx+"/system/attachment/kindeditorUpload?dir=file&module=article&category=default&puuid=11111111111111111111111111111111",afterUpload:function(b){if(0===b.error){console.log(b);var c=KindEditor.formatUrl(b.url,"absolute");a("#"+d.fieldId).textbox("setText",c),a("#"+d.fieldId).textbox("setValue",c),refreshGrid(d.grid.type,d.grid.id)}else alert(b.message)},afterError:function(a){alert("自定义错误信息: "+a)}});g.fileBox.change(function(a){g.submit()})},500)})}),a(document).on(topJUI.eventType.initUI.base,function(b){setTimeout(function(){getTabWindow().$('[data-toggle="topjui-datagrid"]').each(function(b){var c=a(this),d=getOptionsJson(c),e=c.find("thead:first")[0];if(a(e).attr("frozen")){var e=[];c.find("thead:first th").each(function(a){e.push(strToJson("{"+this.getAttribute("data-options")+"}"))}),d.frozenColumns=[e];var f=[];c.find("thead:eq(1) th").each(function(a){f.push(strToJson("{"+this.getAttribute("data-options")+"}"))})}else{var f=[];c.find("thead th").each(function(a){f.push(strToJson("{"+this.getAttribute("data-options")+"}"))})}d.columns=[f];c.attr("id",d.id),getTabWindow().$("#"+d.id).iDatagrid(d)}),getTabWindow().$('[data-toggle="topjui-edatagrid"]').each(function(b){var c=a(this),d=getOptionsJson(c),e=c.find("thead:first")[0];if(a(e).attr("frozen")){var e=[];c.find("thead:first th").each(function(a){e.push(strToJson("{"+this.getAttribute("data-options")+"}"))}),d.frozenColumns=[e];var f=[];c.find("thead:eq(1) th").each(function(a){f.push(strToJson("{"+this.getAttribute("data-options")+"}"))})}else{var f=[];c.find("thead th").each(function(a){f.push(strToJson("{"+this.getAttribute("data-options")+"}"))})}d.columns=[f];c.attr("id",d.id),getTabWindow().$("#"+d.id).iEdatagrid(d)}),getTabWindow().$('[data-toggle="topjui-treegrid"]').each(function(b){var c=a(this),d=getOptionsJson(c),e=[];c.find("th").each(function(a){e.push(strToJson("{"+this.getAttribute("data-options")+"}"))}),d.columns=[e],c.attr("id",d.id),getTabWindow().$("#"+d.id).iTreegrid(d)}),getTabWindow().$('[data-toggle="topjui-tabs"]').each(function(){var b=a(this),c=getOptionsJson(b);b.attr("id",c.id),getTabWindow().$("#"+c.id).iTabs(c)}),getTabWindow().$('[data-toggle="topjui-menubutton"]').each(function(){var b=a(this),c=getOptionsJson(b);c=bindMenuClickEvent(b,c),a(this).iMenubutton(c)}),getTabWindow().$('[data-toggle="topjui-submenubutton"]').each(function(){var b=a(this),c=getOptionsJson(b);bindMenuClickEvent(b,c)})},1),setTimeout(function(){getTabWindow().$('[data-toggle="topjui-dialog"]').each(function(){var b=a(this),c=getOptionsJson(b),d=b.attr("href");void 0!=d?(c.href=d,getTabWindow().$("body").append('<div id="'+c.id+'"></div>'),getTabWindow().$("#"+c.id).iDialog(c),b.on("click",function(){return getTabWindow().$("#"+c.id).dialog("open"),!1})):(b.attr("id",c.id),getTabWindow().$("#"+c.id).iDialog(c))}),getTabWindow().$('[data-toggle="topjui-linkbutton"]').each(function(b){var c=a(this),d=getOptionsJson(c);c.iLinkbutton(d),"ajaxForm"!=d.handler&&"multiAjaxForm"!=d.handler||c.on("click",function(){"undefined"!=d.handlerBefore&&executeCallBackFun(d.handlerBefore);var b={gridId:"datagrid",dialogId:"editDialog"};if(d=a.extend(b,d),getTabWindow().$("#"+d.dialog.id).form("validate")){if(d.ajaxData=getTabWindow().$("#"+d.dialog.id).serialize(),void 0!=d.combotreeFields){var c="";a.each(d.combotreeFields,function(a,b){c+="&"+b.replace(d.postfix,"")+"="+getTabWindow().$("#"+d.dialogId+' input[textboxname="'+b+'"]').combotree("getValues").join(",")+", "}),d.ajaxData+=c}if("multiAjaxForm"==d.handler){var e=getCheckedRowsData(d.grid.type,d.grid.id);if(0==e.length)return void a.messager.alert(topJUI.language.message.title.operationTips,topJUI.language.message.msg.checkSelfGrid,topJUI.language.message.icon.warning);var f="uuid";d.grid.pkName&&(f=d.grid.pkName),d.ajaxData+="&"+f+"="+getMultiRowsFieldValue(e,f)+"&"+f+"s="+getMultiRowsFieldValue(e,f)}if(getTabWindow().doAjax(d),getTabWindow().$("#"+d.dialog.id).dialog("close"),"object"==typeof d.grid)if("datagrid"==d.grid.type)getTabWindow().$("#"+d.grid.id).datagrid("reload");else if("treegrid"==d.grid.type){var g=getSelectedRowData(d.grid.type,d.grid.id);null==g?getTabWindow().$("#"+d.grid.id).treegrid("reload"):getTabWindow().$("#"+d.grid.id).treegrid("reload",g[d.grid.parentIdField])}refreshGrids(d.reload)}else showMessage({statusCode:300,title:"温馨提示",message:"显示红色的字段为必填字段"})})})},1e3)}),a(document).on(topJUI.eventType.initUI.base2,function(b){setTimeout(function(){getTabWindow().$('[data-toggle="topjui-menu"]').each(function(b){var c=a(this),d=getOptionsJson(c);c.attr("id",d.id),getTabWindow().$("#"+d.id).iMenu(d)}),getTabWindow().$('[data-toggle="topjui-tree"]').each(function(b){var c=a(this),d=getOptionsJson(c);c.attr("id",d.id),getTabWindow().$("#"+d.id).iTree(d)})},1500)}),a(document).on(topJUI.eventType.initUI.echarts,function(b){getTabWindow().$('[data-toggle="topjui-echarts"]').length>0&&getTabWindow().$('[data-toggle="topjui-echarts"]').each(function(b){var c=a(this),d=getOptionsJson(c),e=getTabWindow().document.getElementById(c[0].id),f=echarts.init(e);f.setOption({title:{text:""},tooltip:{},legend:{data:[]},series:[]}),a.ajax({url:d.url,type:"post",dataType:"json",success:function(a,b,c){"bar"!=d.type&&"line"!=d.type||f.setOption({title:{text:a.title},xAxis:{data:a.categories},yAxis:{},legend:{data:a.legend},series:a.series}),"pie"==d.type&&f.setOption({title:{text:a.title,x:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:a.legend,series:a.series}),"gauge"==d.type&&f.setOption({tooltip:{formatter:"{a} <br/>{b} : {c}%"},series:[{name:"业务指标",type:"gauge",detail:{formatter:"{value}%"},data:[{value:17.1,name:"党员发展率"}]}]})},error:function(a){alert("获取图表数据失败!"),f.hideLoading()}})})}),a(document).on(topJUI.eventType.initUI.advanceSearchForm,function(b){for(var c=a.cookie("fieldNameStr").split(","),d=a.cookie("colNameStr").split(","),e=[],f=0;f<d.length;f++)e.push({value:c[f],text:d[f]});a(".field:last").combobox({textField:"text",valueField:"value",data:e,editable:!1}),a(".op:last").combobox({textField:"text",valueField:"value",data:[{text:"包含",value:"contains",selected:!0},{text:"等于",value:"equal"},{text:"不等于",value:"notequal"},{text:"大于",value:"greater"},{text:"大于或等于",value:"greaterorequal"},{text:"小于",value:"less"},{text:"小于或等于",value:"lessorequal"},{text:"以...开头",value:"beginwith"},{text:"以...结尾",value:"endwith"}],width:100,panelHeight:198,editable:!1}),a(".value:last").textbox({}),a(".join:last").combobox({textField:"text",valueField:"value",data:[{text:"并且",value:"and",selected:!0},{text:"或者",value:"or"}],width:70,panelHeight:44,editable:!1}),a("#addCondition").menubutton({iconCls:"icon-add",hasDownArrow:!1}),a(".deleteCondition:last").menubutton({iconCls:"icon-delete",hasDownArrow:!1}),a(".deleteCondition:last").on("click",function(){var b=a(".deleteCondition").index(this)+1;getTabWindow().$("#advanceSearchTable tr:eq("+b+")").remove()})}),a(document).on(topJUI.eventType.initUI.importExcelForm,function(b){setTimeout(function(){for(var b=a.cookie("fieldNameStr"),c=b.split(","),d="",e=0;e<c.length;e++)d+=e==c.length-1?"'{"+e+"}'":"'{"+e+"}',";var f="INSERT INTO {table} ("+b+") VALUES ("+d+")";a("#importExcelSql").textbox("setValue",f)},1e3)})}(jQuery),$(function(){var a=getUrl();a!=TopJUI.config.mainPagePath&&($(this).trigger(topJUI.eventType.initUI.base),$(this).trigger(topJUI.eventType.initUI.base2)),$("#advanceSearchDialog").dialog({width:600,height:200,title:"高级查询",modal:!1,collapsible:!0,minimizable:!1,maximized:!1,resizable:!0,closed:!0,iconCls:"icon-find",href:"/system/search/advanceSearch",zIndex:10,buttons:"#advanceSearchDialog-buttons",onLoad:function(){$(this).trigger(topJUI.eventType.initUI.advanceSearchForm)}}),$("#submitAdvanceSearchForm").on("click",function(){for(var a=[],b=$("#advanceSearchDialog").serializeArray(),c=b.length/4,d=0;d<c;d++){var e=(b[4*d].name,b[4*d].value),f=(b[4*d+1].name,b[4*d+1].value),g=(b[4*d+2].name,b[4*d+2].value),h=(b[4*d+3].name,b[4*d+3].value);a.push({field:e,op:f,value:g,join:h})}"datagrid"==$.cookie("gridType")?$("#"+$.cookie("gridId")).datagrid("load",{filterRules:JSON.stringify(a)}):"treegrid"==$.cookie("gridType")&&$("#"+$.cookie("gridId")).treegrid("load",{filterRules:JSON.stringify(a)})}),setTimeout(function(){$("#importExcelDialog").dialog({width:650,height:200,title:"高级查询",modal:!1,collapsible:!0,minimizable:!1,maximized:!1,resizable:!0,closed:!0,iconCls:"icon-find",href:"/system/excel/excelImport",zIndex:10,buttons:"#importExcelDialog-buttons",onLoad:function(){$(this).trigger(topJUI.eventType.initUI.importExcelForm)}})},1e3),$("#submitImportExcelForm").on("click",function(){var a=$("#importExcelDialog").serializeArray();$.ajax({type:"POST",url:getUrl("controller")+"importExcel",data:a,dataType:"json",success:function(a){showMessage({statusCode:a.statusCode,title:a.title,message:a.message}),$("#importExcelDialog").dialog("close").form("reset"),refreshGrid($.cookie("gridType"),$.cookie("gridId"))},error:function(a){showMessage({statusCode:300,title:"操作提示",message:a})}})})}),function(a){a.fn.iTabs=function(b){var c={title:"",closable:!0,iconCls:"",content:"",border:!1,fit:!0},b=a.extend(c,b),d=(a("#"+b.id),!0);a(this).tabs({title:b.title,closable:b.closable,iconCls:b.iconCls,content:b.content,border:b.border,fit:b.fit,onSelect:function(c,e){if(!d){var f=b.component,g={},h=a("#"+b.id+e);if("datagrid"==f[e].type){var i=h.datagrid("options"),j=a("#"+i.parentGrid.id),k=j.datagrid("getSelected");if(k){g=getSelectedRowJson(i.parentGrid.param,k);var l=h.datagrid("options").queryParams;h.datagrid("options").queryParams=a.extend({},l,g),h.datagrid("load")}}else if("treegrid"==f[e].type){var i=h.treegrid("options"),j=a("#"+i.parentGrid.id),k=j.datagrid("getSelected");if(k){g=getSelectedRowJson(i.parentGrid.param,k);var l=h.datagrid("options").queryParams;h.datagrid("options").queryParams=a.extend({},l,g),h.datagrid("load")}}else if("panel"==f[e].type){var m=h.panel("options"),j=a("#"+m.parentGrid.id),k=j.datagrid("getSelected");if(k){var n=replaceUrlParamValueByBrace(m.dynamicHref,k);h.panel("refresh",n)}}}d=!1},onLoad:function(a){}})},a.extend(a.fn.tabs.methods,{myAdd:function(b,c){return b.each(function(){a(this).tabs("add",c)})},bindDblclick:function(b,c){return b.each(function(){var b=this;a(this).children("div.tabs-header").find("ul.tabs").undelegate("li","dblclick.tabs").delegate("li","dblclick.tabs",function(d){if(c&&"function"==typeof c){var e=a(this).text(),f=a(b).tabs("getTabIndex",a(b).tabs("getTab",e));c(f,e)}})})},unbindDblclick:function(b){return b.each(function(){a(this).children("div.tabs-header").find("ul.tabs").undelegate("li","dblclick.tabs")})}})}(jQuery),$(function(){managerTool={reload:function(a){$(a.datagridId).datagrid("reload")},redo:function(a){$(a.datagridId).datagrid("unselectAll")},add:function(a){$(a.addDialogId).dialog("open").form("reset")},remove:function(a){if(a){var b=$(a.datagridId).datagrid("getSelections");b.length>0?$.messager.confirm("确定操作","您确定要删除所选的记录吗？",function(c){if(c){for(var d=[],e=0;e<b.length;e++)d.push("'"+b[e].uuid+"'");$.ajax({type:"POST",url:a.url,data:{uuids:d.join(",")},beforeSend:function(){$(a.datagridId).datagrid("loading")},success:function(b){b&&($(a.datagridId).datagrid("loaded"),$(a.datagridId).datagrid("load"),$(a.datagridId).datagrid("unselectAll"),$.messager.show({title:"温馨提示",msg:"成功删除【"+b+"】条记录！"}))}})}}):$.messager.alert("提示操作","请选择要删除的记录！","info")}},edit:function(a){if(a){var b=$(a.datagridId).datagrid("getSelections");b.length>1?$.messager.alert("提示操作！","编辑数据只能选择一条记录！","warning"):1==b.length?$.ajax({url:a.url,type:"post",dataType:"json",data:{uuid:b[0].uuid},beforeSend:function(){$.messager.progress({text:"正在获取中..."})},success:function(b,c,d){if($.messager.progress("close"),b){var e="{";$.each(a.transferData,function(a,c){e+='"'+c+'": "'+b[c.replace("Edit","")]+'", '}),e+='"endStr": "1"}',$(a.editDialogId).dialog("open"),setTimeout(function(){$(a.editDialogId).form("load",$.parseJSON(e))},100)}else $.messager.alert("获取失败！","未知错误导致失败，请重试！","warning")}}):0==b.length&&$.messager.alert("提示操作！","编辑数据请至少选择一条记录！","warning")}}}}),function(a){a.fn.iTree=function(b){var c={treeId:this.selector,url:ctx+"/system/codeItem/getListByCodesetidAndLevelid?codeSetId={codeSetId}&levelId={levelId}",
expandUrl:ctx+"/system/codeItem/getListByPid?pid={pid}",lines:!1,animate:!0,border:!1,clickEvent:"clickEventName",queryParams:{},onContextMenu:"",refreshDatagridId:"#datagrid"},b=a.extend(c,b);b.url.indexOf("codeSetId")==-1?b.url=b.url+"?codeSetId="+b.codeSetId+"&levelId="+b.levelId:b.url=b.url.replace("{codeSetId}",b.codeSetId).replace("{levelId}",b.levelId),""==b.treeId&&(b.treeId=a(this).context),a(this).tree({url:b.url,lines:b.lines,animate:b.animate,border:b.border,onContextMenu:b.onContextMenu,onBeforeExpand:function(c,d){a(b.treeId).tree("options").url=b.expandUrl.replace("{pid}",c.id)},onClick:function(c){if("postCodeItemIdAndRefreshDatagrid"==b.clickEvent){var d=a(b.refreshDatagridId),e=d.datagrid("options").queryParams;newQueryParams=b.queryParams,newQueryParams.codeSetId=c.codesetid,newQueryParams.codeItemId=c.id,newQueryParams.pid=c.pid,newQueryParams.code=c.code,d.datagrid("options").queryParams=a.extend({},e,newQueryParams),d.datagrid("reload")}else if("postTreeParamsAndRefreshDatagrid"==b.clickEvent){var d=a(b.refreshDatagridId),e=d.datagrid("options").queryParams;newQueryParams=b.queryParams,newQueryParams.codeSetId=c.codesetid,newQueryParams.codeItemId=c.id,newQueryParams.id=c.id,newQueryParams.pid=c.pid,newQueryParams.text=c.text,newQueryParams.code=c.code,d.datagrid("options").queryParams=a.extend({},e,newQueryParams),d.datagrid("reload")}else"closed"==c.state?a(b.treeId).tree("expand",c.target):a(b.treeId).tree("collapse",c.target)},onLoadSuccess:function(){setTimeout(function(){var c=a(b.treeId).tree("getRoot");a(b.treeId).tree("expand",c.target)},1e3)}})}}(jQuery),function(a){a.fn.iTreegrid=function(b){var c={gridId:this.selector,treegridContextId:"treegridContext",url:ctx+"/system/codeItem/getListByCodesetidAndLevelid",queryParams:{codeSetId:a.getUrlParam("codeSetId"),levelId:a.getUrlParam("levelId")},onBeforeExpandUrl:ctx+"/system/codeItem/getListByPid",idField:"id",treeField:"text",border:!1,loadMsg:"数据加载中,请稍后...",toolbar:this.selector+"-toolbar",pagination:!1,pageNumber:1,pageSize:1,pageList:[10,20,30,40,50],animate:!0,columns:[[{field:"text",title:"名称"},{field:"codeSetId",title:"体系代码",width:100},{field:"id",title:"编号"},{field:"pid",title:"父级编号"},{field:"levelId",title:"层级",width:100},{field:"sort",title:"排序",width:100},{field:"code",title:"代码",width:100},{field:"status",title:"状态",width:100}]],checkOnSelect:!1,selectOnCheck:!1,onClickRow:function(a){}},b=a.extend(c,b);a(this).treegrid({url:appendSourceUrlParam(b.url),idField:b.idField,treeField:b.treeField,fit:!0,fitColumns:!0,toolbar:b.toolbar,pagination:b.pagination,pageNumber:1,pageSize:20,pageList:[10,20,30,40,50],animate:b.animate,columns:b.columns,border:b.border,loadMsg:b.loadMsg,checkOnSelect:b.checkOnSelect,selectOnCheck:b.selectOnCheck,onBeforeExpand:function(c){a(this).treegrid("options").url=replaceUrlParamValueByBrace(b.expandUrl,c)},onLoadSuccess:function(){var c=a(b.gridId).treegrid("getRoot");c&&a(b.gridId).treegrid("expand",c.id),a(this).treegrid("options").url=appendSourceUrlParam(b.url)},onContextMenu:function(a,b){},onClickRow:function(c){if("object"==typeof b.childGrid){var d={};d=getSelectedRowJson(b.childGrid.param,c);for(var e=b.childGrid.grid,f=0;f<e.length;f++){var g=a("#"+e[f].id);if("datagrid"==e[f].type){var h=g.datagrid("options").queryParams;g.datagrid("options").queryParams=a.extend({},h,d),g.datagrid("load")}else if("treegrid"==e[f].type){var h=g.treegrid("options").queryParams;g.treegrid("options").queryParams=a.extend({},h,d),g.treegrid("load")}else if("panel"==e[f].type){var i=replaceUrlParamValueByBrace(e[f].href,c);g.panel("refresh",i)}}}}})}}(jQuery),function(a){a.fn.myWindow=function(b){function c(b,c){var d=a('<div region="center" border="false" style="padding:5px;"></div>').html(b);a('<div class="easyui-layout" fit="true"></div>').append(d).append('<div region="south" border="false" style="padding-top:5px;height:40px; overflow:hidden; text-align:center;background:#fafafa;border-top:#eee 1px solid;">  <a iconCls="icon-ok">确定</a><a iconCls="icon-cancel">取消</a></div>').appendTo(a("#w").empty()).layout(),a(".easyui-layout a[iconCls]").linkbutton(),a('a[iconCls="icon-cancel"]').click(function(){a("#w").window("close")}),a('a[iconCls="icon-ok"]').unbind("click").click(c)}var d={width:500,height:400,iconCls:"",collapsible:!1,minimizable:!1,maximizable:!1,resizable:!1,title:"窗口标题",modal:!0,submit:function(){alert("写入执行的代码。")},html:""},b=a.extend(d,b),e=b.html;a("#w").window({title:b.title,width:b.width,height:b.height,content:c(e,b.submit),collapsible:b.collapsible,minimizable:b.minimizable,maximizable:b.maximizable,modal:b.modal,iconCls:b.iconCls}).window("open")}}(jQuery);